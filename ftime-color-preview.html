<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ftime カラースキーム プレビュー</title>
    <style>
        body {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            background-color: #000;
            color: #fff;
            margin: 20px;
            line-height: 1.4;
        }

        .terminal {
            background-color: #1a1a1a;
            border: 2px solid #333;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 8px rgba(0,0,0,0.3);
        }

        .terminal-header {
            background-color: #333;
            color: #fff;
            padding: 8px 12px;
            margin: -20px -20px 20px -20px;
            border-radius: 6px 6px 0 0;
            font-size: 14px;
            border-bottom: 1px solid #555;
        }

        pre {
            margin: 0;
            white-space: pre;
            font-size: 14px;
        }

        /* ヘッダー行 */
        .header {
            color: #ffffff;  /* ヘッダーは白色 */
        }

        /* 時間経過による色分け（3段階） */
        .active {
            color: #32cd32;  /* 4時間以内: 明るい緑（アクティブ作業中） */
        }

        .recent {
            color: #ffffff;  /* 24時間以内: 白（今日の作業） */
        }

        .old {
            color: #888888;  /* 7日以上: グレー（過去の作業） */
        }

        /* 編集マーク */
        .edited-mark {
            color: #ffff00;  /* 黄色の + マーク */
        }

        /* 追加スタイル（プレビュー用） */
        .em-bold-yellow {
            color: #ffeb3b;
            font-weight: 700;
        }
        .em-invert {
            background-color: #ffffff;
            color: #000000;
            padding: 0 2px;
            border-radius: 2px;
            font-weight: 700;
        }
        .em-badge {
            background-color: #ffeb3b;
            color: #000000;
            padding: 0 3px;
            border-radius: 2px;
            font-weight: 700;
        }

        /* ファイル名の色分け（3段階） */
        .file-name.active {
            color: #ffffff;
        }
        
        .file-name.recent {
            color: #ffffff;
        }
        
        .file-name.old {
            color: #aaaaaa;
        }

        .legend {
            background-color: #2a2a2a;
            border-left: 4px solid #00ffff;
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .legend h3 {
            margin-top: 0;
            color: #00ffff;
        }

        .legend-item {
            display: flex;
            align-items: center;
            margin: 8px 0;
        }

        .legend-sample {
            font-family: 'Consolas', 'Monaco', 'Courier New', monospace;
            margin-right: 15px;
            min-width: 120px;
        }

        .controls {
            margin: 20px 0;
        }

        button {
            background-color: #444;
            color: #fff;
            border: 1px solid #666;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
            font-family: inherit;
        }

        button:hover {
            background-color: #555;
        }

        button.active {
            background-color: #007acc;
            border-color: #0099ff;
        }

        .no-color pre * {
            color: #ffffff !important;
        }

        h1, h2 {
            color: #00ffff;
        }

        .description {
            background-color: #2a2a2a;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
            color: #ccc;
        }
    </style>
</head>
<body>
    <h1>ftime カラースキーム プレビュー</h1>
    
    <div class="description">
        <strong>改善案A</strong>: 実用的な3段階時間分類 + 編集マーク（+記号）<br>
        アクティブ作業中のファイルを強調し、認知負荷を最小化する視覚改善案
    </div>

    <div class="controls">
        <button id="colorBtn" class="active" onclick="toggleColor()">カラー表示</button>
        <button id="noColorBtn" onclick="toggleColor()">モノクロ表示</button>
        <div style="margin-top:8px">
            <label for="markStyle">編集マーク:</label>
            <select id="markStyle">
                <option value="plus">+（現行）</option>
                <option value="boldPlus">✚（太字・黄）</option>
                <option value="invertEDIT">EDIT（反転風）</option>
                <option value="badge">✚（黄背景バッジ）</option>
                <option value="pencil">✎（ペン）</option>
            </select>
        </div>
        <div style="margin-top:8px">
            <label for="timeFormat">日時フォーマット:</label>
            <select id="timeFormat">
                <option value="mmdd_uscore">MM/DD_HH:MM（現行）</option>
                <option value="iso">YYYY-MM-DD HH:MM（ISO風）</option>
                <option value="md_hyphen">MM-DD HH:MM（ハイフン・非US寄り）</option>
                <option value="md_space_tz">MM/DD HH:MM JST（TZ表示）</option>
                <option value="iso_tz">YYYY-MM-DDTHH:MM+0900（ISO+TZ）</option>
            </select>
        </div>
    </div>

    <div class="terminal" id="output">
        <div class="terminal-header">❯ ftime</div>
        <pre><span class="header">MODIFIED     CREATED      NAME</span>
<span class="active time">12/28_16:30</span>  <span class="active time">12/28_16:30</span>  <span class="file-name active">new-script.py</span>       <span style="color: #555;">← アクティブ作業中 (4時間以内)</span>
<span class="active time">12/28_14:15</span><span class="edited-mark">+</span> <span class="old time">12/01_09:00</span>  <span class="file-name active">config.json</span>       <span style="color: #555;">← 現在編集中 (2時間前)</span>
<span class="recent time">12/28_09:45</span>  <span class="recent time">12/28_09:45</span>  <span class="file-name recent">README.md</span>          <span style="color: #555;">← 今日の作業 (朝作成)</span>
<span class="recent time">12/28_08:20</span><span class="edited-mark">+</span> <span class="old time">12/20_16:30</span>  <span class="file-name recent">app.js</span>             <span style="color: #555;">← 今日更新 (編集済み)</span>
<span class="old time">12/20_14:22</span>  <span class="old time">12/20_14:22</span>  <span class="file-name old">styles.css</span>         <span style="color: #555;">← 過去の作業 (8日前)</span>
<span class="old time">11/15_10:30</span><span class="edited-mark">+</span> <span class="old time">08/20_12:00</span>  <span class="file-name old">package.json</span>       <span style="color: #555;">← 古いファイル (編集済み)</span></pre>
    </div>

    <div class="legend">
        <h3>📈 カラースキーム説明</h3>
        
        <div class="legend-item">
            <span class="legend-sample active">12/28_16:30</span>
            <span><strong>4時間以内</strong> - 明るい緑（アクティブ作業中）</span>
        </div>
        
        <div class="legend-item">
            <span class="legend-sample recent">12/28_09:45+</span>
            <span><strong>24時間以内</strong> - 白色（今日の作業）+ 編集時は黄色の"+"マーク</span>
        </div>
        
        <div class="legend-item">
            <span class="legend-sample old">12/20_14:22</span>
            <span><strong>7日以上</strong> - グレー（過去の作業）</span>
        </div>
    </div>

    <div class="legend">
        <h3>✨ 視覚的改善効果</h3>
        <ul>
            <li><strong>アクティブ作業の強調</strong> - 現在作業中のファイルが明確に識別可能</li>
            <li><strong>認知負荷の軽減</strong> - 3段階分類で瞬時に判断可能</li>
            <li><strong>作業効率アップ</strong> - 今日の作業ファイルがすぐ分かる</li>
            <li><strong>ノイズ削減</strong> - 古いファイルが視覚的に後退</li>
            <li><strong>編集履歴が明確</strong> - "+"マークで編集されたファイルを識別</li>
            <li><strong>実用性重視</strong> - 実際の開発ワークフローに合致した時間設定</li>
        </ul>
    </div>

    <div class="legend">
        <h3>🎛️ カスタマイズオプション</h3>
        <ul>
            <li><code>FTL_NO_TIME_COLOR=1</code> - 色分けを無効化</li>
            <li><code>FTL_ACTIVE_HOURS=4</code> - アクティブ時間（時間単位、デフォルト4時間）</li>
            <li><code>FTL_RECENT_HOURS=24</code> - 今日の作業時間（時間単位、デフォルト24時間）</li>
            <li><code>FTL_EDIT_MARK='*'</code> - 編集マークを"*"に変更</li>
        </ul>
    </div>

    <script>
        let colorMode = true;

        function toggleColor() {
            const output = document.getElementById('output');
            const colorBtn = document.getElementById('colorBtn');
            const noColorBtn = document.getElementById('noColorBtn');
            
            if (colorMode) {
                output.classList.add('no-color');
                colorBtn.classList.remove('active');
                noColorBtn.classList.add('active');
                colorMode = false;
            } else {
                output.classList.remove('no-color');
                colorBtn.classList.add('active');
                noColorBtn.classList.remove('active');
                colorMode = true;
            }
        }

        function applyEditMarkStyle(style) {
            const marks = document.querySelectorAll('.edited-mark');
            marks.forEach(m => {
                m.classList.remove('em-bold-yellow', 'em-invert', 'em-badge');
                switch (style) {
                    case 'plus':
                        m.textContent = '+';
                        break;
                    case 'boldPlus':
                        m.textContent = '✚';
                        m.classList.add('em-bold-yellow');
                        break;
                    case 'invertEDIT':
                        m.textContent = 'EDIT';
                        m.classList.add('em-invert');
                        break;
                    case 'badge':
                        m.textContent = '✚';
                        m.classList.add('em-badge');
                        break;
                    case 'pencil':
                        m.textContent = '✎';
                        m.classList.add('em-bold-yellow');
                        break;
                }
            });
        }

        function applyTimeFormat(fmt) {
            const times = document.querySelectorAll('.time');
            times.forEach(t => {
                if (!t.dataset.base) {
                    t.dataset.base = t.textContent.trim();
                }
                const base = t.dataset.base;
                const m = base.match(/^(\d{2})\/(\d{2})_(\d{2}):(\d{2})$/);
                if (!m) return;
                const MM = m[1], DD = m[2], HH = m[3], mm = m[4];
                let out = base;
                switch (fmt) {
                    case 'mmdd_uscore':
                        out = `${MM}/${DD}_${HH}:${mm}`;
                        break;
                    case 'iso':
                        out = `2025-${MM}-${DD} ${HH}:${mm}`;
                        break;
                    case 'md_hyphen':
                        out = `${MM}-${DD} ${HH}:${mm}`;
                        break;
                    case 'md_space_tz':
                        out = `${MM}/${DD} ${HH}:${mm} JST`;
                        break;
                    case 'iso_tz':
                        out = `2025-${MM}-${DD}T${HH}:${mm}+0900`;
                        break;
                }
                t.textContent = out;
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            const sel = document.getElementById('markStyle');
            applyEditMarkStyle(sel.value);
            sel.addEventListener('change', () => applyEditMarkStyle(sel.value));

            const tf = document.getElementById('timeFormat');
            applyTimeFormat(tf.value);
            tf.addEventListener('change', () => applyTimeFormat(tf.value));
        });
    </script>
</body>
</html>